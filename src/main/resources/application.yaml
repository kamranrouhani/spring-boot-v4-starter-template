spring:
  application:
    name: template

  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:h2:mem:testdb}
    username: ${SPRING_DATASOURCE_USERNAME:sa}
    password: ${SPRING_DATASOURCE_PASSWORD:}
    # driver-class-name: ${SPRING_DATASOURCE_DRIVER:org.h2.Driver}  # Added

  jpa:
    hibernate:
      ddl-auto: ${SPRING_JPA_HIBERNATE_DDL_AUTO:validate}
    show-sql: ${SPRING_JPA_SHOW_SQL:false}
    properties:
      hibernate:
        format_sql: true
        # dialect: ${SPRING_JPA_DIALECT:org.hibernate.dialect.H2Dialect}  # Added

  h2:
    console:
      enabled: ${H2_CONSOLE_ENABLED:true}  # Changed - now configurable
      path: /h2-console

  # Flyway configuration
  flyway:
    enabled: ${SPRING_FLYWAY_ENABLED:true}
    locations: classpath:db/migration

    # PRODUCTION-SAFE DEFAULTS
    clean-disabled: ${SPRING_FLYWAY_CLEAN_DISABLED:true}
    validate-on-migrate: ${SPRING_FLYWAY_VALIDATE_ON_MIGRATE:true}
    baseline-on-migrate: ${SPRING_FLYWAY_BASELINE_ON_MIGRATE:false}

  # Email Configuration
  mail:
    host: ${MAIL_HOST:smtp.gmail.com}
    port: ${MAIL_PORT:587}
    username: ${MAIL_USERNAME:}
    password: ${MAIL_PASSWORD:}
    properties:
      mail:
        smtp:
          auth: ${MAIL_SMTP_AUTH:false}  # ← CHANGED: Now configurable via env var
          starttls:
            enable: ${MAIL_SMTP_STARTTLS:false}  # ← CHANGED: Now configurable
          connectiontimeout: 5000
          timeout: 5000
          writetimeout: 5000
  messages:
    basename: messages
    fallback-to-system-locale: false

# Application-specific settings
app:
  email:
    from: ${APP_EMAIL_FROM:noreply@template.com}
    verification-url: ${APP_EMAIL_VERIFICATION_URL:http://localhost:8080/api/auth/verify-email}
  verification:
    token-validity-hours: ${APP_VERIFICATION_TOKEN_VALIDITY:24}

jwt:
  secret: ${JWT_SECRET:only-for-local-testing-change-in-production}  # Added default
  expiration: ${JWT_EXPIRATION:86400000}

server:
  port: ${SERVER_PORT:8080}

# Swagger/OpenAPI configuration
springdoc:
  api-docs:
    enabled: ${SPRINGDOC_ENABLED:true}  # Disable in production
  swagger-ui:
    enabled: ${SPRINGDOC_ENABLED:true}  # Disable in production

logging:
  level:
    root: ${LOG_LEVEL_ROOT:INFO}
    com.kamran.template: ${LOG_LEVEL_APP:DEBUG}
    org.springframework.web: ${LOG_LEVEL_SPRING_WEB:INFO}
    org.springframework.security: ${LOG_LEVEL_SPRING_SECURITY:INFO}
    org.springframework.boot.autoconfigure: ${LOG_LEVEL_SPRING_BOOT:INFO}
    org.hibernate.SQL: ${LOG_LEVEL_HIBERNATE_SQL:DEBUG}
    org.hibernate.type.descriptor.sql.BasicBinder: ${LOG_LEVEL_HIBERNATE_BINDER:TRACE}
    com.zaxxer.hikari: ${LOG_LEVEL_HIKARI:INFO}
    org.flywaydb: ${LOG_LEVEL_FLYWAY:DEBUG}
    org.springframework.mail: ${LOG_LEVEL_MAIL:DEBUG}

  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} %5p [%15.15t] %-40.40logger{39} : %m%n"
